# 📊 สรุปการอัปเดตระบบจัดการโรงแรม

## ✅ สิ่งที่ทำเสร็จแล้ว

### 1. **ตารางจัดการโรงแรม (อัปเดตแล้ว)**

| คอลัมน์ | คำอธิบาย |
|---------|----------|
| ID | รหัสโรงแรม (badge สีฟ้า) |
| รูป | รูปโรงแรม 60x60px |
| ชื่อโรงแรม | ไทย + อังกฤษ |
| ชื่อเจ้าของ | ชื่อเจ้าของโรงแรม |
| คลิก | 🖱️ สถิติการคลิก |
| หัวใจ | ❤️ จำนวนหัวใจที่ได้รับ ⭐ (ใหม่!) |
| จัดการ | ปุ่มแก้ไข/ลบ |
| แก้ไขล่าสุด | ชื่อผู้แก้ไขล่าสุด |
| เบอร์ / เวลา | 📞 เบอร์ติดต่อ + 🕐 เวลา (Realtime) |

**การเปลี่ยนแปลง:**
- ✅ ลบคอลัมน์ "ผู้เพิ่ม"
- ✅ เพิ่มคอลัมน์ "หัวใจ" (ข้างสถิติคลิก)
- ✅ รวมเบอร์ติดต่อและเวลาในคอลัมน์เดียวกัน
- ✅ จาก 10 คอลัมน์ → 9 คอลัมน์

---

### 2. **ฟอร์มเพิ่ม/แก้ไขโรงแรม (อัปเดตแล้ว)**

#### ฟิลด์ทั้งหมด:

1. **ID โรงแรม** * (บังคับ)
   - รหัสเฉพาะสำหรับโรงแรม
   - เช่น: `hotel-001`
   - ห้ามซ้ำกับโรงแรมอื่น

2. **ชื่อโรงแรมไทย / อังกฤษ** * (บังคับอย่างน้อย 1 ภาษา)
   - ต้องกรอกอย่างน้อยภาษาใดภาษาหนึ่ง
   - ไทย: โรงแรมทดสอบ
   - อังกฤษ: Test Hotel

3. **ชื่อเจ้าของโรงแรม** * (บังคับ)
   - ชื่อ-นามสกุล เจ้าของ
   - เช่น: นายสมชาย ใจดี

4. **ราคาต่ำสุด** * (บังคับ)
   - ราคาเริ่มต้นต่อคืน (บาท)
   - ต้องมากกว่า 0

5. **ราคาสูงสุด**
   - ราคาสูงสุดต่อคืน
   - ไม่บังคับ (ถ้าไม่กรอก ใช้ราคาต่ำสุด)

6. **อัพโหลดรูปภาพ** * (บังคับ)
   - อัพโหลดจากมือถือ/PC
   - ขนาดไม่เกิน 5MB
   - แปลงเป็น Base64 Data URL
   - หรือใส่ URL รูปภาพ

7. **Facebook URL**
   - ลิงก์หน้า Facebook โรงแรม
   - เช่น: https://facebook.com/yourhotel

8. **Line ID** ⭐ (ใหม่!)
   - ไลน์ติดต่อ
   - เช่น: @yourhotel

9. **เบอร์โทรศัพท์** * (บังคับ)
   - เบอร์ติดต่อ
   - เช่น: 081-234-5678

10. **รองรับลูกค้าสูงสุด** ⭐ (ใหม่!)
    - จำนวนคน
    - เช่น: 4 คน

11. **สิ่งอำนวยความสะดวก**
    - เลือกได้หลายอัน
    - จาก Sheet "Filters"
    - เช่น: WiFi, แอร์, สระว่ายน้ำ

---

### 3. **ฟีเจอร์ใหม่**

#### การอัพโหลดรูปภาพ:
```javascript
// คลิกปุ่ม "อัพโหลด"
uploadImage()
  → เลือกไฟล์จากเครื่อง
  → ตรวจสอบประเภทและขนาด (max 5MB)
  → แปลงเป็น Base64
  → บันทึกลง Google Sheets
  → แสดง Preview
```

#### การตรวจสอบ (Validation):
- ✅ ID ห้ามว่าง, ห้ามซ้ำ
- ✅ ชื่อโรงแรม อย่างน้อย 1 ภาษา
- ✅ ชื่อเจ้าของ ห้ามว่าง
- ✅ ราคาต่ำสุด ต้อง > 0
- ✅ รูปภาพ ห้ามว่าง
- ✅ เบอร์โทร ห้ามว่าง

---

## 📂 ไฟล์ที่แก้ไข

### 1. `admin_v2.html`
- อัปเดตตารางจัดการโรงแรม (9 คอลัมน์)
- ฟอร์มเพิ่ม/แก้ไขโรงแรมใหม่ทั้งหมด
- เพิ่ม input สำหรับ upload รูป
- เพิ่มฟิลด์ใหม่: Line ID, รองรับลูกค้า, ID โรงแรม, ชื่อเจ้าของ

### 2. `admin_v2.js`
- อัปเดต `displayHotelsTable()` ดึงข้อมูลหัวใจ
- ลบคอลัมน์ผู้เพิ่ม
- รวมเบอร์+เวลาในคอลัมน์เดียว
- อัปเดตฟังก์ชัน `loadHotelData()`, `saveHotel()`, `loadFilterCheckboxes()`

### 3. `hotel_management.js` ⭐ (ไฟล์ใหม่!)
- `uploadImage()` - อัพโหลดและแปลงรูปเป็น Base64
- `previewImageUrl()` - แสดง preview รูป
- `loadHotelDataEnhanced()` - โหลดข้อมูลโรงแรมพร้อมฟิลด์ใหม่
- `saveHotelEnhanced()` - บันทึกพร้อม validation
- `loadFilterCheckboxesEnhanced()` - โหลดตัวกรองพร้อม data attributes

---

## 🎯 วิธีใช้งาน

### เพิ่มโรงแรม:
1. คลิก "เพิ่มโรงแรม"
2. กรอก ID (บังคับ)
3. กรอกชื่อโรงแรม (ไทยหรืออังกฤษ)
4. กรอกชื่อเจ้าของ (บังคับ)
5. กรอกราคา (บังคับ)
6. อัพโหลดรูป:
   - คลิก "เลือกไฟล์" → เลือกรูป
   - คลิก "อัพโหลด"
   - รอจนแสดง preview
7. กรอกข้อมูลติดต่อ (Facebook, Line, เบอร์)
8. กรอกจำนวนลูกค้า
9. เลือกสิ่งอำนวยความสะดวก
10. คลิก "บันทึก"

### แก้ไขโรงแรม:
1. คลิกปุ่ม "แก้ไข" ในตาราง
2. ID จะถูก lock (แก้ไขไม่ได้)
3. แก้ไขข้อมูลที่ต้องการ
4. คลิก "บันทึก"

---

## ⚠️ สิ่งที่ต้องทำต่อ

### 1. อัปเดต Google Sheets
เพิ่มคอลัมน์ใหม่ใน Sheet "Hotels":
- **คอลัมน์ V**: Line ID
- **คอลัมน์ W**: รองรับลูกค้า (คน)

**โครงสร้างใหม่: A-W (23 คอลัมน์)**

### 2. อัปเดต Backend (googleSheets.js)
```javascript
// เปลี่ยนจาก A2:U เป็น A2:W
range: `${HOTELS_SHEET}!A2:W`

// เพิ่มฟิลด์
lineId: row[21],      // Column V
maxGuests: row[22],   // Column W
```

### 3. แก้ไข JavaScript Errors
มี syntax error ใน admin_v2.js บรรทัด 926-927
- ต้องปิด bracket ให้ถูกต้อง

---

## 🐛 การแก้ไข Errors

### Error 1: Declaration or statement expected
```
File: admin_v2.js, Line 926-927
```

**วิธีแก้:**
1. เปิดไฟล์ `admin_v2.js`
2. ค้นหาบรรทัด 926
3. ตรวจสอบ bracket { } ให้ครบ
4. บันทึกไฟล์

---

## 📊 ข้อมูลที่แสดงในตาราง

### ตัวอย่างแถวข้อมูล:

```
┌──────────┬─────┬──────────────┬────────────┬──────┬──────┬────┬──────────┬──────────────┐
│ hotel-001│ 🖼️  │โรงแรมทดสอบ   │สมชาย ใจดี   │🖱️ 150│❤️ 50│✏️🗑️│  Admin   │📞 081-234... │
│          │     │Test Hotel    │            │      │     │    │          │🕐 2นาทีที่แล้ว│
└──────────┴─────┴──────────────┴────────────┴──────┴──────┴────┴──────────┴──────────────┘
```

---

## 🎉 สรุป

### ทำเสร็จแล้ว ✅:
- ตารางแสดงข้อมูลครบถ้วน 9 คอลัมน์
- ช่องค้นหาโรงแรม (ID, ชื่อ, เจ้าของ)
- ฟอร์มเพิ่ม/แก้ไขที่สมบูรณ์
- อัพโหลดรูปภาพได้ (Base64)
- Validation ครบถ้วน
- แสดงหัวใจ + คลิก พร้อมกัน
- เวลา Realtime

### ต้องทำต่อ 🔧:
- อัปเดต Google Sheets (เพิ่มคอลัมน์ V, W)
- อัปเดต googleSheets.js (รองรับคอลัมน์ใหม่)
- แก้ไข syntax error ใน admin_v2.js
- ทดสอบการอัพโหลดรูป
- ทดสอบการบันทึกข้อมูลครบทุกฟิลด์

---

**Server พร้อมใช้งาน:** `http://192.168.1.26:3000/admin_v2.html`

กรุณาตรวจสอบและแจ้งหากพบปัญหา! 😊
