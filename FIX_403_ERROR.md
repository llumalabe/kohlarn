# üîß ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Error 403 Forbidden

## ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: Google Sheets API Error 403

### ‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏‡∏ó‡∏µ‡πà‡∏û‡∏ö:
```
Error: (403) Forbidden
Message: Method doesn't allow unregistered callers
```

---

## ‚úÖ ‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç (‡∏ó‡∏≥‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö)

### 1Ô∏è‚É£ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ Google Sheets ‡πÅ‡∏ä‡∏£‡πå‡πÄ‡∏õ‡πá‡∏ô Public

1. **‡πÄ‡∏õ‡∏¥‡∏î Google Sheets** ‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏™‡∏£‡πâ‡∏≤‡∏á
2. **‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏° "Share"** (‡∏°‡∏∏‡∏°‡∏Ç‡∏ß‡∏≤‡∏ö‡∏ô)
3. ‡∏î‡∏π‡∏ß‡πà‡∏≤‡∏ï‡∏£‡∏á **"General access"** ‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏∞‡πÑ‡∏£:
   
   ‚ùå **‡∏ú‡∏¥‡∏î:** "Restricted" (‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ä‡∏¥‡∏ç‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô)
   
   ‚úÖ **‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á:** "Anyone with the link" (‡πÉ‡∏Ñ‡∏£‡∏°‡∏µ link ‡∏Å‡πá‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏î‡πâ)

4. **‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÅ‡∏ä‡∏£‡πå:**
   - ‡∏Ñ‡∏•‡∏¥‡∏Å "Restricted"
   - ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô **"Anyone with the link"**
   - Role: **"Viewer"** (‡πÉ‡∏´‡πâ‡∏î‡∏π‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß)
   - ‡∏Ñ‡∏•‡∏¥‡∏Å **"Done"**

---

### 2Ô∏è‚É£ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö API Key Restrictions

1. **‡πÄ‡∏õ‡∏¥‡∏î [Google Cloud Console](https://console.cloud.google.com)**
2. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **"APIs & Services"** ‚Üí **"Credentials"**
3. **‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà API Key ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì** (‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô key ‡∏ó‡∏µ‡πà‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢ AIzaSy...)
4. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö **"Application restrictions"**:

   **‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 1: ‡πÑ‡∏°‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î (‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏î‡∏™‡∏≠‡∏ö)**
   - ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å **"None"**
   - ‡∏Ñ‡∏•‡∏¥‡∏Å **"SAVE"**
   
   **‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 2: ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡πÄ‡∏â‡∏û‡∏≤‡∏∞ IP/Domain (‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏Å‡∏ß‡πà‡∏≤)**
   - ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å **"HTTP referrers (websites)"**
   - ‡πÄ‡∏û‡∏¥‡πà‡∏° referrers:
     ```
     http://192.168.1.26:3000/*
     http://localhost:3000/*
     ```
   - ‡∏Ñ‡∏•‡∏¥‡∏Å **"SAVE"**

5. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö **"API restrictions"**:
   - ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å **"Restrict key"**
   - ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏â‡∏û‡∏≤‡∏∞ **"Google Sheets API"**
   - ‡∏Ñ‡∏•‡∏¥‡∏Å **"SAVE"**

---

### 3Ô∏è‚É£ ‡∏£‡∏≠‡πÉ‡∏´‡πâ API Key Activate

**‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:** ‡∏´‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á API Key ‡πÉ‡∏´‡∏°‡πà ‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç restrictions:
- ‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏≠ **1-5 ‡∏ô‡∏≤‡∏ó‡∏µ** ‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó
- ‡∏ö‡∏≤‡∏á‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏≠‡∏≤‡∏à‡∏ô‡∏≤‡∏ô‡∏ñ‡∏∂‡∏á **10 ‡∏ô‡∏≤‡∏ó‡∏µ**

---

### 4Ô∏è‚É£ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö API Key

**‡πÄ‡∏õ‡∏¥‡∏î PowerShell ‡πÅ‡∏•‡πâ‡∏ß‡∏û‡∏¥‡∏°‡∏û‡πå:**

```powershell
# ‡∏ó‡∏î‡∏™‡∏≠‡∏ö API Key (‡πÅ‡∏ó‡∏ô YOUR_API_KEY ‡∏î‡πâ‡∏ß‡∏¢ API Key ‡∏à‡∏£‡∏¥‡∏á)
curl "https://sheets.googleapis.com/v4/spreadsheets/1lrveylO3qD8fZlJWqiyEz3KaRojT3PObzTMqIt1hKNA?key=YOUR_API_KEY"
```

**‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á:**
```json
{
  "spreadsheetId": "1lrveylO3qD8fZlJWqiyEz3KaRojT3PObzTMqIt1hKNA",
  "properties": {
    "title": "Koh Larn Hotels Database",
    ...
  }
}
```

**‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á Error 403:**
- ‡∏£‡∏≠ 2-3 ‡∏ô‡∏≤‡∏ó‡∏µ ‡πÅ‡∏•‡πâ‡∏ß‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÅ‡∏ä‡∏£‡πå Sheets ‡πÄ‡∏õ‡πá‡∏ô Public ‡πÅ‡∏•‡πâ‡∏ß
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ API restrictions ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á

---

### 5Ô∏è‚É£ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏ü‡∏•‡πå .env

‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏ü‡∏•‡πå `.env` ‡πÅ‡∏•‡πâ‡∏ß‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:

```env
# ‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏û‡∏¥‡πÄ‡∏®‡∏©
GOOGLE_SHEET_ID=1lrveylO3qD8fZlJWqiyEz3KaRojT3PObzTMqIt1hKNA
GOOGLE_API_KEY=AIzaSyAk0B-Zxx6F5adbq_faIpC308-KygHwo6E
PORT=3000
```

**‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:**
- ‚úÖ ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏´‡∏•‡∏±‡∏á `=`
- ‚úÖ ‡πÑ‡∏°‡πà‡∏°‡∏µ quote `"` ‡∏´‡∏£‡∏∑‡∏≠ `'`
- ‚úÖ API Key ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏Ñ‡∏±‡πà‡∏ô)
- ‚úÖ Spreadsheet ID ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (44 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£)

---

### 6Ô∏è‚É£ Restart Server

```powershell
# ‡∏´‡∏¢‡∏∏‡∏î server ‡πÄ‡∏Å‡πà‡∏≤
Get-Process -Name node | Stop-Process -Force

# ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà
npm start
```

---

## üêõ ‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏à‡∏∏‡∏î

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: API Key ‡∏°‡∏µ‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á

‡∏à‡∏≤‡∏Å‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏£‡∏±‡∏ô:
```powershell
curl "...key=AIzaSy yAk0B-Zxx6F5adbq..."
                  ^ ‡∏°‡∏µ‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ!
```

**‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
1. ‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏ü‡∏•‡πå `.env`
2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö `GOOGLE_API_KEY` ‡∏ß‡πà‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á
3. ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á ‡πÉ‡∏´‡πâ‡∏•‡∏ö‡∏≠‡∏≠‡∏Å
4. ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ü‡∏•‡πå
5. Restart server

---

## üéØ Quick Fix (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏£‡πá‡∏ß)

**‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏£‡πá‡∏ß‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î:**

### Option 1: ‡∏õ‡∏¥‡∏î API Restrictions ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà [Google Cloud Console > Credentials](https://console.cloud.google.com/apis/credentials)
2. ‡∏Ñ‡∏•‡∏¥‡∏Å API Key
3. **Application restrictions**: ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å **"None"**
4. **API restrictions**: ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å **"Don't restrict key"**
5. ‡∏Ñ‡∏•‡∏¥‡∏Å **"SAVE"**
6. **‡∏£‡∏≠ 2-3 ‡∏ô‡∏≤‡∏ó‡∏µ**
7. ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà

### Option 2: ‡∏™‡∏£‡πâ‡∏≤‡∏á API Key ‡πÉ‡∏´‡∏°‡πà

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà [Google Cloud Console > Credentials](https://console.cloud.google.com/apis/credentials)
2. ‡∏Ñ‡∏•‡∏¥‡∏Å **"+ CREATE CREDENTIALS"** ‚Üí **"API key"**
3. ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å API Key ‡πÉ‡∏´‡∏°‡πà
4. **‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ restrictions** (‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡πà‡∏≠‡∏ô)
5. ‡πÅ‡∏Å‡πâ `.env`:
   ```env
   GOOGLE_API_KEY=API_KEY_‡πÉ‡∏´‡∏°‡πà‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
   ```
6. Restart server

---

## ‚úÖ Checklist ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç

‡∏ó‡∏≥‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö:

- [ ] 1. Google Sheets ‡πÅ‡∏ä‡∏£‡πå‡πÄ‡∏õ‡πá‡∏ô "Anyone with the link - Viewer"
- [ ] 2. API Key ‡πÑ‡∏°‡πà‡∏°‡∏µ restrictions (‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏î‡∏™‡∏≠‡∏ö)
- [ ] 3. ‡∏£‡∏≠ 2-3 ‡∏ô‡∏≤‡∏ó‡∏µ ‡πÉ‡∏´‡πâ API Key activate
- [ ] 4. ‡πÑ‡∏ü‡∏•‡πå .env ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á)
- [ ] 5. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢ curl
- [ ] 6. Restart server
- [ ] 7. ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ß‡πá‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö

---

## üß™ ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ó‡∏î‡∏™‡∏≠‡∏ö

### ‡∏ó‡∏î‡∏™‡∏≠‡∏ö 1: Spreadsheet Info
```powershell
curl "https://sheets.googleapis.com/v4/spreadsheets/1lrveylO3qD8fZlJWqiyEz3KaRojT3PObzTMqIt1hKNA?key=AIzaSyAk0B-Zxx6F5adbq_faIpC308-KygHwo6E"
```

**‡∏Ñ‡∏ß‡∏£‡πÑ‡∏î‡πâ:** JSON ‡∏ó‡∏µ‡πà‡∏°‡∏µ `spreadsheetId` ‡πÅ‡∏•‡∏∞ `properties`

### ‡∏ó‡∏î‡∏™‡∏≠‡∏ö 2: Read Hotels Data
```powershell
curl "https://sheets.googleapis.com/v4/spreadsheets/1lrveylO3qD8fZlJWqiyEz3KaRojT3PObzTMqIt1hKNA/values/Hotels!A2:Z?key=AIzaSyAk0B-Zxx6F5adbq_faIpC308-KygHwo6E"
```

**‡∏Ñ‡∏ß‡∏£‡πÑ‡∏î‡πâ:** JSON ‡∏ó‡∏µ‡πà‡∏°‡∏µ `values` array

---

## üí° ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏

1. **API Key ‡πÄ‡∏õ‡πá‡∏ô Public** - ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡πÅ‡∏Ñ‡πà‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Read-only)
2. **‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•** - ‡πÄ‡∏ß‡πá‡∏ö‡∏à‡∏∞‡∏≠‡πà‡∏≤‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß
3. **‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢** - ‡πÄ‡∏û‡∏£‡∏≤‡∏∞ Sheet ‡πÄ‡∏õ‡πá‡∏ô "Viewer" ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß

---

**‡∏•‡∏≠‡∏á‡∏ó‡∏≥‡∏ï‡∏≤‡∏° Checklist ‡πÅ‡∏•‡πâ‡∏ß‡∏ö‡∏≠‡∏Å‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏Ñ‡∏£‡∏±‡∏ö!** üöÄ
