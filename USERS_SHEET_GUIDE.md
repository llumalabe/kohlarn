# คู่มือการตั้งค่า Users Sheet และ Activity Log

## การสร้าง Sheet สำหรับระบบผู้ใช้งาน

### 1. Users Sheet (สำหรับจัดการผู้ใช้งาน)

สร้าง Sheet ใหม่ชื่อ **Users** ใน Google Sheets เดียวกันกับ Hotels Sheet

**โครงสร้างคอลัมน์:**

| A | B | C | D |
|---|---|---|---|
| Username | Password | Nickname | Role |
| admin | yourpassword | ผู้ดูแลระบบ | admin |
| john | john123 | จอห์น | admin |
| mary | mary456 | แมรี่ | admin |

**คำอธิบาย:**
- **Username**: ชื่อผู้ใช้สำหรับเข้าสู่ระบบ
- **Password**: รหัสผ่าน
- **Nickname**: ชื่อเล่นที่จะแสดงในระบบ
- **Role**: บทบาท (ตอนนี้รองรับ admin เท่านั้น)

### 2. ActivityLog Sheet (สำหรับเก็บประวัติการทำงาน)

สร้าง Sheet ใหม่ชื่อ **ActivityLog**

**โครงสร้างคอลัมน์:**

| A | B | C | D | E |
|---|---|---|---|---|
| Timestamp | Username | Nickname | Action | HotelName |
| 05/10/2025 14:30:25 | admin | ผู้ดูแลระบบ | เข้าสู่ระบบ | |
| 05/10/2025 14:35:12 | john | จอห์น | เพิ่มโรงแรม | Sea View Resort |
| 05/10/2025 15:20:33 | mary | แมรี่ | แก้ไขโรงแรม | Beach Hotel |

**คำอธิบาย:**
- **Timestamp**: วันเวลาที่ทำรายการ
- **Username**: ชื่อผู้ใช้ที่ทำรายการ
- **Nickname**: ชื่อเล่นของผู้ใช้
- **Action**: การกระทำ (เข้าสู่ระบบ, เพิ่มโรงแรม, แก้ไขโรงแรม, ลบโรงแรม, etc.)
- **HotelName**: ชื่อโรงแรมที่เกี่ยวข้อง (ถ้ามี)

### 3. Filters Sheet (สำหรับจัดการตัวกรอง)

สร้าง Sheet ใหม่ชื่อ **Filters**

**โครงสร้างคอลัมน์:**

| A | B | C | D | E |
|---|---|---|---|---|
| ID | NameTh | NameEn | Icon | Enabled |
| beachfront | ติดทะเล | Beachfront | fa-umbrella-beach | true |
| breakfast | รวมอาหารเช้า | Breakfast Included | fa-utensils | true |
| freeShuttle | ฟรีรถรับส่ง | Free Shuttle | fa-bus | true |

**คำอธิบาย:**
- **ID**: รหัสตัวกรอง (ใช้ภาษาอังกฤษ ไม่มีช่องว่าง)
- **NameTh**: ชื่อตัวกรองภาษาไทย
- **NameEn**: ชื่อตัวกรองภาษาอังกฤษ
- **Icon**: ไอคอน Font Awesome (ดูได้ที่ fontawesome.com/icons)
- **Enabled**: true หรือ false (เปิดใช้งานหรือไม่)

### 4. อัปเดต Hotels Sheet

เพิ่ม 2 คอลัมน์ใหม่ใน **Hotels** Sheet:

| Q | R |
|---|---|
| LastEditBy | LastEditTime |
| ผู้ดูแลระบบ | 05/10/2025 14:35:12 |
| จอห์น | 05/10/2025 15:20:33 |

**คำอธิบาย:**
- **LastEditBy** (คอลัมน์ Q): ชื่อเล่นของผู้แก้ไขล่าสุด
- **LastEditTime** (คอลัมน์ R): วันเวลาที่แก้ไขล่าสุด

## ระบบการเข้าสู่ระบบใหม่

### บัญชีชั่วคราวสำหรับทดสอบ:
- **Username**: admin
- **Password**: 123456
- **Nickname**: ผู้ดูแลระบบ

### การสร้างบัญชีผู้ใช้งานใหม่:
1. เปิด Google Sheets
2. ไปที่ Sheet "Users"
3. เพิ่มแถวใหม่ด้วยข้อมูล:
   - Username: ชื่อผู้ใช้ที่ต้องการ
   - Password: รหัสผ่าน
   - Nickname: ชื่อเล่นที่จะแสดงในระบบ
   - Role: admin

## ฟีเจอร์ใหม่

### 1. ระบบยินดีต้อนรับ
- เมื่อเข้าสู่ระบบจะแสดงข้อความ "ยินดีต้อนรับ [ชื่อเล่น]" ที่หัวข้อหน้า

### 2. แสดงชื่อผู้แก้ไขล่าสุด
- ในตารางจัดการโรงแรม จะแสดงว่าใครแก้ไขล่าสุดและเมื่อไหร่

### 3. ประวัติการแก้ไข (Activity Log)
- แสดงรายการการทำงานของผู้ใช้ทั้งหมดแบบ Real-time
- แสดง 10 รายการต่อหน้า
- เรียงจากล่าสุดก่อน
- มีระบบแบ่งหน้า (Pagination)

### 4. จัดการตัวกรอง
- เพิ่มตัวกรองใหม่
- แก้ไขตัวกรองที่มีอยู่
- ลบตัวกรอง
- ระบบจะบันทึกลง Google Sheets โดยอัตโนมัติ

## การทำงานของระบบ

### เมื่อผู้ใช้ทำการแก้ไขข้อมูล:
1. ระบบจะบันทึกชื่อเล่นของผู้แก้ไขในโรงแรม
2. บันทึกเวลาที่แก้ไข
3. บันทึกประวัติการทำงานลง ActivityLog Sheet
4. แสดงผลแบบ Real-time ในหน้าประวัติการแก้ไข

### ประเภทการทำงานที่บันทึก:
- เข้าสู่ระบบ
- เพิ่มโรงแรม
- แก้ไขโรงแรม
- ลบโรงแรม
- เพิ่มตัวกรอง
- แก้ไขตัวกรอง
- ลบตัวกรอง

## การลบบัญชีชั่วคราว

เมื่อต้องการนำระบบขึ้น Production:
1. เปิดไฟล์ `services/users.js`
2. ค้นหาบรรทัด:
```javascript
const TEMP_USERNAME = 'admin';
const TEMP_PASSWORD = '123456';
const TEMP_NICKNAME = 'ผู้ดูแลระบบ';
```
3. เปลี่ยนเป็น:
```javascript
const TEMP_USERNAME = '';
const TEMP_PASSWORD = '';
const TEMP_NICKNAME = '';
```
4. Restart server

## หมายเหตุสำคัญ

- ⚠️ ระบบต้องการ **Service Account** เพื่อเขียนข้อมูลลง Google Sheets
- ⚠️ หากยังไม่ได้ตั้งค่า Service Account ระบบจะอ่านข้อมูลได้อย่างเดียว
- ⚠️ Activity Log จะไม่สามารถบันทึกได้หากไม่มี Write Permission
- ✅ บัญชีชั่วคราว (admin/123456) สามารถใช้งานได้ทันทีโดยไม่ต้องตั้งค่า Google Sheets
